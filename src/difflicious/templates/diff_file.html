<!-- Single File Diff -->
<div class="file-diff bg-white border border-gray-200 rounded-lg shadow-sm" data-file="{{ file.path }}">
    <!-- File Header -->
    <div class="file-header flex items-center justify-between p-4 cursor-pointer hover:bg-gray-50 transition-colors"
         onclick="toggleFile('{{ file.path }}')">
        <div class="flex items-center space-x-3">
            <span class="toggle-icon text-gray-400 transition-transform duration-200"
                data-expanded="{{ 'true' if file.expanded else 'false' }}">
                {{ 'â–¼' if file.expanded else 'â–¶' }}
            </span>
            <span class="font-mono text-sm text-gray-900">{{ file.path }}</span>
            <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded">
                {{ file.status }}
            </span>
        </div>

        <div class="flex items-center space-x-2 text-xs">
            <!-- File Navigation -->
            <div class="flex items-center space-x-1" onclick="event.stopPropagation()">
                <button onclick="navigateToPreviousFile('{{ file.path }}')"
                    class="p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors"
                    title="Previous file">
                    <span class="text-sm">â†‘</span>
                </button>
                <button onclick="navigateToNextFile('{{ file.path }}')"
                    class="p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors"
                    title="Next file">
                    <span class="text-sm">â†“</span>
                </button>
            </div>

            <!-- File Stats -->
            {% if file.additions > 0 %}
            <span class="bg-green-100 text-green-800 px-2 py-1 rounded">
                +{{ file.additions }}
            </span>
            {% endif %}
            {% if file.deletions > 0 %}
            <span class="bg-red-100 text-red-800 px-2 py-1 rounded">
                -{{ file.deletions }}
            </span>
            {% endif %}
        </div>
    </div>

    <!-- File Content -->
    <div class="file-content border-t border-gray-200" data-file-content="{{ file.path }}"
        style="display: {{ 'block' if file.expanded else 'none' }};">
        {% if not file.hunks or file.hunks|length == 0 %}
        <!-- No content available -->
        <div class="p-8 text-center text-gray-500">
            <div class="text-4xl mb-2">ðŸ“„</div>
            <p>No diff content available</p>
            <p class="text-sm">(Binary file, untracked, or no changes)</p>
        </div>
        {% else %}
        <!-- Render hunks -->
        {% for hunk in file.hunks %}
        {% include "diff_hunk.html" with context %}
        {% endfor %}
        {% endif %}
    </div>
</div>
